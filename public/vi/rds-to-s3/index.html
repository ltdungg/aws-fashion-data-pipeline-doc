<!DOCTYPE html>
<html lang="vi" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.143.1">
    <meta name="generator" content="Relearn 7.6.1+b0c6bb558d7728ac4535a2ac677c5f47297203cc">
    <meta name="description" content="Tổng quan Trong phần này, chúng ta sẽ sử dụng AWS Lambda để trích xuất dữ liệu từ Amazon RDS và lưu vào Amazon S3. Chúng ta sẽ sử dụng một hàm Lambda đơn giản để thực hiện việc này. Hàm Lambda sẽ được kích hoạt sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL để lấy dữ liệu và sau đó lưu dữ liệu vào Amazon S3 dưới dạng file CSV. Đầu tiên tải zip file Lambda function tại đây, bấm nút download raw file góc bên phải màn hình để tải xuống. Đây là code của hàm Lambda, chúng ta sẽ không đi sâu vào chi tiết code trong phần này. Chúng ta chỉ cần biết rằng hàm Lambda này sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL và lưu dữ liệu vào Amazon S3. import psycopg2 from datetime import datetime, timedelta import boto3 import os import pandas as pd # Variables RDS_HOST = os.getenv(&#34;RDS_HOST&#34;) RDS_PASSWORD = os.getenv(&#34;RDS_PASSWORD&#34;) db_params = { &#39;dbname&#39;: &#39;postgres&#39;, &#39;user&#39;: &#39;postgres&#39;, &#39;password&#39;: RDS_PASSWORD, &#39;host&#39;: RDS_HOST, &#39;port&#39;: 5432 } DATE_EXECUTION = None # S3 RAW_BUCKET = os.getenv(&#34;S3_BUCKET&#34;) s3 = boto3.client(&#39;s3&#39;) def get_table_data(table_name, query): conn = psycopg2.connect(**db_params) cursor = conn.cursor() print(f&#34;Getting table {table_name} data...&#34;) # Execute the query cursor.execute(query) # Fetch all records records = cursor.fetchall() # Get column names col_names = [desc[0] for desc in cursor.description] # Convert to DataFrame df = pd.DataFrame(records, columns=col_names) print(f&#34;Successfully retrieved records from {table_name} table.&#34;) return df def put_csv_to_s3(df, bucket_name, file_name): # Convert DataFrame to CSV csv_data = df.to_csv(index=False) # Upload to S3 s3.put_object(Bucket=bucket_name, Key=file_name, Body=csv_data) print(f&#34;File {file_name} uploaded to S3 bucket {bucket_name}&#34;) def lambda_handler(event, context): try: DATE_EXECUTION = event[&#34;DATE_EXECUTION&#34;] except Exception as e: DATE_EXECUTION = (datetime.now() - timedelta(days=1)).strftime(&#34;%Y-%m-%d&#34;) # Orders Table table_name = &#34;orders&#34; orders_query = f&#34;&#34;&#34; SELECT * FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39; &#34;&#34;&#34; orders_df = get_table_data(table_name, orders_query) orders_file_name = f&#34;orders/orders_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(orders_df, RAW_BUCKET, orders_file_name) # Order Details Table table_name = &#34;order_details&#34; order_details_query = f&#34;&#34;&#34; SELECT * FROM order_details WHERE order_id IN (SELECT id FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39;) &#34;&#34;&#34; order_details_df = get_table_data(table_name, order_details_query) order_details_file_name = f&#34;order_details/order_details_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(order_details_df, RAW_BUCKET, order_details_file_name) # Users Table table_name = &#34;users&#34; users_query = f&#34;&#34;&#34; SELECT * FROM users &#34;&#34;&#34; users_df = get_table_data(table_name, users_query) users_file_name = f&#34;users/users_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(users_df, RAW_BUCKET, users_file_name) # Products Table table_name = &#34;products&#34; products_query = f&#34;&#34;&#34; SELECT * FROM products &#34;&#34;&#34; products_df = get_table_data(table_name, products_query) products_file_name = f&#34;products/products_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(products_df, RAW_BUCKET, products_file_name) print(&#34;All data has been successfully uploaded to S3.&#34;) Truy cập vào S3 Truy cập vào AWS Console, tìm kiếm và chọn S3 từ menu dịch vụ. Bấm vào bucket fashion-logic-zone mà chúng ta đã tạo ở phần trước. Tại giao diện bucket, bấm Upload 4. Tại giao diện Upload:">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="4. Trích xuất dữ liệu từ RDS vào S3 :: AWS Fashion Pipeline">
    <meta name="twitter:description" content="Tổng quan Trong phần này, chúng ta sẽ sử dụng AWS Lambda để trích xuất dữ liệu từ Amazon RDS và lưu vào Amazon S3. Chúng ta sẽ sử dụng một hàm Lambda đơn giản để thực hiện việc này. Hàm Lambda sẽ được kích hoạt sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL để lấy dữ liệu và sau đó lưu dữ liệu vào Amazon S3 dưới dạng file CSV. Đầu tiên tải zip file Lambda function tại đây, bấm nút download raw file góc bên phải màn hình để tải xuống. Đây là code của hàm Lambda, chúng ta sẽ không đi sâu vào chi tiết code trong phần này. Chúng ta chỉ cần biết rằng hàm Lambda này sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL và lưu dữ liệu vào Amazon S3. import psycopg2 from datetime import datetime, timedelta import boto3 import os import pandas as pd # Variables RDS_HOST = os.getenv(&#34;RDS_HOST&#34;) RDS_PASSWORD = os.getenv(&#34;RDS_PASSWORD&#34;) db_params = { &#39;dbname&#39;: &#39;postgres&#39;, &#39;user&#39;: &#39;postgres&#39;, &#39;password&#39;: RDS_PASSWORD, &#39;host&#39;: RDS_HOST, &#39;port&#39;: 5432 } DATE_EXECUTION = None # S3 RAW_BUCKET = os.getenv(&#34;S3_BUCKET&#34;) s3 = boto3.client(&#39;s3&#39;) def get_table_data(table_name, query): conn = psycopg2.connect(**db_params) cursor = conn.cursor() print(f&#34;Getting table {table_name} data...&#34;) # Execute the query cursor.execute(query) # Fetch all records records = cursor.fetchall() # Get column names col_names = [desc[0] for desc in cursor.description] # Convert to DataFrame df = pd.DataFrame(records, columns=col_names) print(f&#34;Successfully retrieved records from {table_name} table.&#34;) return df def put_csv_to_s3(df, bucket_name, file_name): # Convert DataFrame to CSV csv_data = df.to_csv(index=False) # Upload to S3 s3.put_object(Bucket=bucket_name, Key=file_name, Body=csv_data) print(f&#34;File {file_name} uploaded to S3 bucket {bucket_name}&#34;) def lambda_handler(event, context): try: DATE_EXECUTION = event[&#34;DATE_EXECUTION&#34;] except Exception as e: DATE_EXECUTION = (datetime.now() - timedelta(days=1)).strftime(&#34;%Y-%m-%d&#34;) # Orders Table table_name = &#34;orders&#34; orders_query = f&#34;&#34;&#34; SELECT * FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39; &#34;&#34;&#34; orders_df = get_table_data(table_name, orders_query) orders_file_name = f&#34;orders/orders_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(orders_df, RAW_BUCKET, orders_file_name) # Order Details Table table_name = &#34;order_details&#34; order_details_query = f&#34;&#34;&#34; SELECT * FROM order_details WHERE order_id IN (SELECT id FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39;) &#34;&#34;&#34; order_details_df = get_table_data(table_name, order_details_query) order_details_file_name = f&#34;order_details/order_details_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(order_details_df, RAW_BUCKET, order_details_file_name) # Users Table table_name = &#34;users&#34; users_query = f&#34;&#34;&#34; SELECT * FROM users &#34;&#34;&#34; users_df = get_table_data(table_name, users_query) users_file_name = f&#34;users/users_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(users_df, RAW_BUCKET, users_file_name) # Products Table table_name = &#34;products&#34; products_query = f&#34;&#34;&#34; SELECT * FROM products &#34;&#34;&#34; products_df = get_table_data(table_name, products_query) products_file_name = f&#34;products/products_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(products_df, RAW_BUCKET, products_file_name) print(&#34;All data has been successfully uploaded to S3.&#34;) Truy cập vào S3 Truy cập vào AWS Console, tìm kiếm và chọn S3 từ menu dịch vụ. Bấm vào bucket fashion-logic-zone mà chúng ta đã tạo ở phần trước. Tại giao diện bucket, bấm Upload 4. Tại giao diện Upload:">
    <meta property="og:url" content="http://localhost:1313/vi/rds-to-s3/index.html">
    <meta property="og:site_name" content="AWS Fashion Pipeline">
    <meta property="og:title" content="4. Trích xuất dữ liệu từ RDS vào S3 :: AWS Fashion Pipeline">
    <meta property="og:description" content="Tổng quan Trong phần này, chúng ta sẽ sử dụng AWS Lambda để trích xuất dữ liệu từ Amazon RDS và lưu vào Amazon S3. Chúng ta sẽ sử dụng một hàm Lambda đơn giản để thực hiện việc này. Hàm Lambda sẽ được kích hoạt sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL để lấy dữ liệu và sau đó lưu dữ liệu vào Amazon S3 dưới dạng file CSV. Đầu tiên tải zip file Lambda function tại đây, bấm nút download raw file góc bên phải màn hình để tải xuống. Đây là code của hàm Lambda, chúng ta sẽ không đi sâu vào chi tiết code trong phần này. Chúng ta chỉ cần biết rằng hàm Lambda này sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL và lưu dữ liệu vào Amazon S3. import psycopg2 from datetime import datetime, timedelta import boto3 import os import pandas as pd # Variables RDS_HOST = os.getenv(&#34;RDS_HOST&#34;) RDS_PASSWORD = os.getenv(&#34;RDS_PASSWORD&#34;) db_params = { &#39;dbname&#39;: &#39;postgres&#39;, &#39;user&#39;: &#39;postgres&#39;, &#39;password&#39;: RDS_PASSWORD, &#39;host&#39;: RDS_HOST, &#39;port&#39;: 5432 } DATE_EXECUTION = None # S3 RAW_BUCKET = os.getenv(&#34;S3_BUCKET&#34;) s3 = boto3.client(&#39;s3&#39;) def get_table_data(table_name, query): conn = psycopg2.connect(**db_params) cursor = conn.cursor() print(f&#34;Getting table {table_name} data...&#34;) # Execute the query cursor.execute(query) # Fetch all records records = cursor.fetchall() # Get column names col_names = [desc[0] for desc in cursor.description] # Convert to DataFrame df = pd.DataFrame(records, columns=col_names) print(f&#34;Successfully retrieved records from {table_name} table.&#34;) return df def put_csv_to_s3(df, bucket_name, file_name): # Convert DataFrame to CSV csv_data = df.to_csv(index=False) # Upload to S3 s3.put_object(Bucket=bucket_name, Key=file_name, Body=csv_data) print(f&#34;File {file_name} uploaded to S3 bucket {bucket_name}&#34;) def lambda_handler(event, context): try: DATE_EXECUTION = event[&#34;DATE_EXECUTION&#34;] except Exception as e: DATE_EXECUTION = (datetime.now() - timedelta(days=1)).strftime(&#34;%Y-%m-%d&#34;) # Orders Table table_name = &#34;orders&#34; orders_query = f&#34;&#34;&#34; SELECT * FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39; &#34;&#34;&#34; orders_df = get_table_data(table_name, orders_query) orders_file_name = f&#34;orders/orders_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(orders_df, RAW_BUCKET, orders_file_name) # Order Details Table table_name = &#34;order_details&#34; order_details_query = f&#34;&#34;&#34; SELECT * FROM order_details WHERE order_id IN (SELECT id FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39;) &#34;&#34;&#34; order_details_df = get_table_data(table_name, order_details_query) order_details_file_name = f&#34;order_details/order_details_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(order_details_df, RAW_BUCKET, order_details_file_name) # Users Table table_name = &#34;users&#34; users_query = f&#34;&#34;&#34; SELECT * FROM users &#34;&#34;&#34; users_df = get_table_data(table_name, users_query) users_file_name = f&#34;users/users_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(users_df, RAW_BUCKET, users_file_name) # Products Table table_name = &#34;products&#34; products_query = f&#34;&#34;&#34; SELECT * FROM products &#34;&#34;&#34; products_df = get_table_data(table_name, products_query) products_file_name = f&#34;products/products_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(products_df, RAW_BUCKET, products_file_name) print(&#34;All data has been successfully uploaded to S3.&#34;) Truy cập vào S3 Truy cập vào AWS Console, tìm kiếm và chọn S3 từ menu dịch vụ. Bấm vào bucket fashion-logic-zone mà chúng ta đã tạo ở phần trước. Tại giao diện bucket, bấm Upload 4. Tại giao diện Upload:">
    <meta property="og:locale" content="vi">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="4. Trích xuất dữ liệu từ RDS vào S3 :: AWS Fashion Pipeline">
    <meta itemprop="description" content="Tổng quan Trong phần này, chúng ta sẽ sử dụng AWS Lambda để trích xuất dữ liệu từ Amazon RDS và lưu vào Amazon S3. Chúng ta sẽ sử dụng một hàm Lambda đơn giản để thực hiện việc này. Hàm Lambda sẽ được kích hoạt sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL để lấy dữ liệu và sau đó lưu dữ liệu vào Amazon S3 dưới dạng file CSV. Đầu tiên tải zip file Lambda function tại đây, bấm nút download raw file góc bên phải màn hình để tải xuống. Đây là code của hàm Lambda, chúng ta sẽ không đi sâu vào chi tiết code trong phần này. Chúng ta chỉ cần biết rằng hàm Lambda này sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL và lưu dữ liệu vào Amazon S3. import psycopg2 from datetime import datetime, timedelta import boto3 import os import pandas as pd # Variables RDS_HOST = os.getenv(&#34;RDS_HOST&#34;) RDS_PASSWORD = os.getenv(&#34;RDS_PASSWORD&#34;) db_params = { &#39;dbname&#39;: &#39;postgres&#39;, &#39;user&#39;: &#39;postgres&#39;, &#39;password&#39;: RDS_PASSWORD, &#39;host&#39;: RDS_HOST, &#39;port&#39;: 5432 } DATE_EXECUTION = None # S3 RAW_BUCKET = os.getenv(&#34;S3_BUCKET&#34;) s3 = boto3.client(&#39;s3&#39;) def get_table_data(table_name, query): conn = psycopg2.connect(**db_params) cursor = conn.cursor() print(f&#34;Getting table {table_name} data...&#34;) # Execute the query cursor.execute(query) # Fetch all records records = cursor.fetchall() # Get column names col_names = [desc[0] for desc in cursor.description] # Convert to DataFrame df = pd.DataFrame(records, columns=col_names) print(f&#34;Successfully retrieved records from {table_name} table.&#34;) return df def put_csv_to_s3(df, bucket_name, file_name): # Convert DataFrame to CSV csv_data = df.to_csv(index=False) # Upload to S3 s3.put_object(Bucket=bucket_name, Key=file_name, Body=csv_data) print(f&#34;File {file_name} uploaded to S3 bucket {bucket_name}&#34;) def lambda_handler(event, context): try: DATE_EXECUTION = event[&#34;DATE_EXECUTION&#34;] except Exception as e: DATE_EXECUTION = (datetime.now() - timedelta(days=1)).strftime(&#34;%Y-%m-%d&#34;) # Orders Table table_name = &#34;orders&#34; orders_query = f&#34;&#34;&#34; SELECT * FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39; &#34;&#34;&#34; orders_df = get_table_data(table_name, orders_query) orders_file_name = f&#34;orders/orders_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(orders_df, RAW_BUCKET, orders_file_name) # Order Details Table table_name = &#34;order_details&#34; order_details_query = f&#34;&#34;&#34; SELECT * FROM order_details WHERE order_id IN (SELECT id FROM orders WHERE order_date &gt;= &#39;{DATE_EXECUTION} 00:00:00&#39; AND order_date &lt;= &#39;{DATE_EXECUTION} 23:59:59&#39;) &#34;&#34;&#34; order_details_df = get_table_data(table_name, order_details_query) order_details_file_name = f&#34;order_details/order_details_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(order_details_df, RAW_BUCKET, order_details_file_name) # Users Table table_name = &#34;users&#34; users_query = f&#34;&#34;&#34; SELECT * FROM users &#34;&#34;&#34; users_df = get_table_data(table_name, users_query) users_file_name = f&#34;users/users_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(users_df, RAW_BUCKET, users_file_name) # Products Table table_name = &#34;products&#34; products_query = f&#34;&#34;&#34; SELECT * FROM products &#34;&#34;&#34; products_df = get_table_data(table_name, products_query) products_file_name = f&#34;products/products_{DATE_EXECUTION}.csv&#34; put_csv_to_s3(products_df, RAW_BUCKET, products_file_name) print(&#34;All data has been successfully uploaded to S3.&#34;) Truy cập vào S3 Truy cập vào AWS Console, tìm kiếm và chọn S3 từ menu dịch vụ. Bấm vào bucket fashion-logic-zone mà chúng ta đã tạo ở phần trước. Tại giao diện bucket, bấm Upload 4. Tại giao diện Upload:">
    <meta itemprop="wordCount" content="804">
    <title>4. Trích xuất dữ liệu từ RDS vào S3 :: AWS Fashion Pipeline</title>
    <link href="/vi/rds-to-s3/index.xml" rel="alternate" type="application/rss+xml" title="4. Trích xuất dữ liệu từ RDS vào S3 :: AWS Fashion Pipeline"><link rel="icon" href="https://static-00.iconduck.com/assets.00/aws-icon-512x512-4v2f55fn.png" type="image/png">
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1744901602" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1744901602" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1744901602" rel="stylesheet">
    <link href="/css/theme.css?1744901602" rel="stylesheet">
    <link href="/css/format-html.css?1744901602" rel="stylesheet" id="R-format-style">
    <link href="/css/auto-complete/auto-complete.min.css?1744901602" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1744901602" defer></script>
    <script src="/js/lunr/lunr.min.js?1744901602" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1744901602" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1744901602" defer></script>
    <script src="/js/lunr/lunr.vi.min.js?1744901602" defer></script>
    <script src="/js/search.js?1744901602" defer></script>
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/vi\/rds-to-s3\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.contentLangs=['vi'];
      window.relearn.index_js_url="/searchindex.vi.js?1744901602";
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // variant stuff
      window.relearn.themevariants = [ 'my-branding' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
      // translations
      window.T_Copy_to_clipboard = `Sao chép vào bảng tạm`;
      window.T_Copied_to_clipboard = `Sao chép vào bảng tạm!`;
      window.T_Copy_link_to_clipboard = `Sao chép nối kết vào bảng tạm`;
      window.T_Link_copied_to_clipboard = `Liên kết được sao chép vào bảng tạm!`;
      window.T_Reset_view = `Đặt lại dạng xem`;
      window.T_View_reset = `Xem đặt lại!`;
      window.T_No_results_found = `Không tìm thấy kết quả nào cho "{0}"`;
      window.T_N_results_found = `{1} kết quả được tìm thấy cho "{0}"`;
    </script>
    <link href="/css/custom.css?1744901602" rel="stylesheet">
  </head>
  <body class="mobile-support html" data-url="/vi/rds-to-s3/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Mục lục (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#tổng-quan">Tổng quan</a></li>
    <li><a href="#truy-cập-vào-s3">Truy cập vào S3</a></li>
    <li><a href="#tạo-lambda-function">Tạo Lambda function</a></li>
    <li><a href="#cho-phép-lambda-truy-cập-vào-rds">Cho phép Lambda truy cập vào RDS</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/vi/index.html"><span itemprop="name">AWS Fashion Pipeline</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">4. Trích xuất dữ liệu từ RDS vào S3</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/vi/generate-data/index.html" title="3. Tạo môi trường ứng dụng (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/vi/test-connection/index.html" title="5. Test dữ liệu (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Nội dung khác"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable rds-to-s3" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="4-trích-xuất-dữ-liệu-từ-rds-vào-s3">4. Trích xuất dữ liệu từ RDS vào S3</h1>

<h2 id="tổng-quan">Tổng quan</h2>
<ul>
<li>Trong phần này, chúng ta sẽ sử dụng AWS Lambda để trích xuất dữ liệu từ Amazon RDS và lưu vào Amazon S3. Chúng ta sẽ sử dụng một hàm Lambda đơn giản để thực hiện việc này.</li>
<li>Hàm Lambda sẽ được kích hoạt sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL để lấy dữ liệu và sau đó lưu dữ liệu vào Amazon S3 dưới dạng file CSV.</li>
<li>Đầu tiên tải zip file Lambda function <a href="https://github.com/ltdungg/aws-fashion-data-pipeline/blob/main/lambda/rds-to-s3/rds-to-s3-lambda.zip" rel="external" target="_blank">tại đây</a>, bấm nút <strong>download raw file</strong> góc bên phải màn hình để tải xuống.</li>
<li>Đây là code của hàm Lambda, chúng ta sẽ không đi sâu vào chi tiết code trong phần này. Chúng ta chỉ cần biết rằng hàm Lambda này sẽ kết nối đến Amazon RDS, thực hiện truy vấn SQL và lưu dữ liệu vào Amazon S3.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> psycopg2
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, timedelta
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> boto3
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Variables</span>
</span></span><span style="display:flex;"><span>RDS_HOST <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;RDS_HOST&#34;</span>)
</span></span><span style="display:flex;"><span>RDS_PASSWORD <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;RDS_PASSWORD&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>db_params <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;dbname&#39;</span>: <span style="color:#e6db74">&#39;postgres&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;user&#39;</span>: <span style="color:#e6db74">&#39;postgres&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;password&#39;</span>: RDS_PASSWORD,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;host&#39;</span>: RDS_HOST,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;port&#39;</span>: <span style="color:#ae81ff">5432</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>DATE_EXECUTION <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># S3</span>
</span></span><span style="display:flex;"><span>RAW_BUCKET <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;S3_BUCKET&#34;</span>)
</span></span><span style="display:flex;"><span>s3 <span style="color:#f92672">=</span> boto3<span style="color:#f92672">.</span>client(<span style="color:#e6db74">&#39;s3&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_table_data</span>(table_name, query):
</span></span><span style="display:flex;"><span>    conn <span style="color:#f92672">=</span> psycopg2<span style="color:#f92672">.</span>connect(<span style="color:#f92672">**</span>db_params)
</span></span><span style="display:flex;"><span>    cursor <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Getting table </span><span style="color:#e6db74">{</span>table_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> data...&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Execute the query</span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(query)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Fetch all records</span>
</span></span><span style="display:flex;"><span>    records <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchall()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get column names</span>
</span></span><span style="display:flex;"><span>    col_names <span style="color:#f92672">=</span> [desc[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> desc <span style="color:#f92672">in</span> cursor<span style="color:#f92672">.</span>description]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Convert to DataFrame</span>
</span></span><span style="display:flex;"><span>    df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(records, columns<span style="color:#f92672">=</span>col_names)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Successfully retrieved records from </span><span style="color:#e6db74">{</span>table_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> table.&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">put_csv_to_s3</span>(df, bucket_name, file_name):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Convert DataFrame to CSV</span>
</span></span><span style="display:flex;"><span>    csv_data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>to_csv(index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Upload to S3</span>
</span></span><span style="display:flex;"><span>    s3<span style="color:#f92672">.</span>put_object(Bucket<span style="color:#f92672">=</span>bucket_name, Key<span style="color:#f92672">=</span>file_name, Body<span style="color:#f92672">=</span>csv_data)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;File </span><span style="color:#e6db74">{</span>file_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> uploaded to S3 bucket </span><span style="color:#e6db74">{</span>bucket_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lambda_handler</span>(event, context):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        DATE_EXECUTION <span style="color:#f92672">=</span> event[<span style="color:#e6db74">&#34;DATE_EXECUTION&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        DATE_EXECUTION <span style="color:#f92672">=</span> (datetime<span style="color:#f92672">.</span>now() <span style="color:#f92672">-</span> timedelta(days<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Orders Table</span>
</span></span><span style="display:flex;"><span>    table_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;orders&#34;</span>
</span></span><span style="display:flex;"><span>    orders_query <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            SELECT * FROM orders
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            WHERE order_date &gt;= &#39;</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74"> 00:00:00&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            AND order_date &lt;= &#39;</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74"> 23:59:59&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    orders_df <span style="color:#f92672">=</span> get_table_data(table_name, orders_query)
</span></span><span style="display:flex;"><span>    orders_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;orders/orders_</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74">.csv&#34;</span>
</span></span><span style="display:flex;"><span>    put_csv_to_s3(orders_df, RAW_BUCKET, orders_file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Order Details Table</span>
</span></span><span style="display:flex;"><span>    table_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;order_details&#34;</span>
</span></span><span style="display:flex;"><span>    order_details_query <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            SELECT * FROM order_details
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            WHERE order_id IN 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                (SELECT id FROM orders
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                WHERE order_date &gt;= &#39;</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74"> 00:00:00&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                AND order_date &lt;= &#39;</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74"> 23:59:59&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    order_details_df <span style="color:#f92672">=</span> get_table_data(table_name, order_details_query)
</span></span><span style="display:flex;"><span>    order_details_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;order_details/order_details_</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74">.csv&#34;</span>
</span></span><span style="display:flex;"><span>    put_csv_to_s3(order_details_df, RAW_BUCKET, order_details_file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Users Table</span>
</span></span><span style="display:flex;"><span>    table_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;users&#34;</span>
</span></span><span style="display:flex;"><span>    users_query <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            SELECT * FROM users
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    users_df <span style="color:#f92672">=</span> get_table_data(table_name, users_query)
</span></span><span style="display:flex;"><span>    users_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;users/users_</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74">.csv&#34;</span>
</span></span><span style="display:flex;"><span>    put_csv_to_s3(users_df, RAW_BUCKET, users_file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Products Table</span>
</span></span><span style="display:flex;"><span>    table_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;products&#34;</span>
</span></span><span style="display:flex;"><span>    products_query <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            SELECT * FROM products
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    products_df <span style="color:#f92672">=</span> get_table_data(table_name, products_query)
</span></span><span style="display:flex;"><span>    products_file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;products/products_</span><span style="color:#e6db74">{</span>DATE_EXECUTION<span style="color:#e6db74">}</span><span style="color:#e6db74">.csv&#34;</span>
</span></span><span style="display:flex;"><span>    put_csv_to_s3(products_df, RAW_BUCKET, products_file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;All data has been successfully uploaded to S3.&#34;</span>)</span></span></code></pre></div>
<h2 id="truy-cập-vào-s3">Truy cập vào S3</h2>
<ol>
<li>Truy cập vào AWS Console, tìm kiếm và chọn <strong>S3</strong> từ menu dịch vụ.</li>
<li>Bấm vào bucket <code>fashion-logic-zone</code> mà chúng ta đã tạo ở phần trước.</li>
<li>Tại giao diện bucket, bấm <strong>Upload</strong></li>
</ol>
<p><a href="#R-image-17a6b1999cc3cbb4e8eb18ba3b2c84f6" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_3.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-17a6b1999cc3cbb4e8eb18ba3b2c84f6"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_3.png"></a>
4. Tại giao diện <strong>Upload</strong>:</p>
<ul>
<li>Bấm <strong>Add files</strong>, chọn file <code>rds-to-s3-lambda.zip</code> mà chúng ta đã tải xuống ở trên.</li>
<li>Bấm <strong>Upload</strong>.</li>
</ul>
<p><a href="#R-image-a2a6a00cf601489230dfa2967b23d482" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_4.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a2a6a00cf601489230dfa2967b23d482"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_4.png"></a></p>
<ol start="5">
<li>Sau khi upload thành công, chúng ta sẽ thấy file <code>rds-to-s3-lambda.zip</code> trong bucket. Lưu lại Object URL của file này, chúng ta sẽ sử dụng nó trong hàm Lambda.</li>
</ol>
<h2 id="tạo-lambda-function">Tạo Lambda function</h2>
<ol>
<li>
<p>Truy cập vào AWS Console, tìm kiếm và chọn <strong>Lambda</strong> từ menu dịch vụ.
<a href="#R-image-bc484cc7f5e9487a1235d091c1838659" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-bc484cc7f5e9487a1235d091c1838659"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img.png"></a></p>
</li>
<li>
<p>Bấm vào <strong>Create function</strong>.</p>
</li>
</ol>
<p><a href="#R-image-4caac35adcbff0c0222ed83ec235eafc" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4caac35adcbff0c0222ed83ec235eafc"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_1.png"></a></p>
<ol start="3">
<li>Tại giao diện <strong>Create function</strong>
<ul>
<li>Chọn <strong>Author from scratch</strong>.</li>
<li>Nhập tên cho function là <code>lambda-rds-to-s3</code>.</li>
<li>Chọn <strong>Python 3.13</strong> cho Runtime.</li>
<li>Bấm Change default execution role.
<ul>
<li>Chọn <strong>Use an existing role</strong>.</li>
<li>Chọn role <code>lambda-s3-full-access</code> mà chúng ta đã tạo ở phần trước.</li>
</ul>
</li>
<li>Bấm <strong>Create function</strong>.</li>
</ul>
</li>
</ol>
<p><a href="#R-image-bf6eb1b5f4d9dea802a4558e7edae290" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_2.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-bf6eb1b5f4d9dea802a4558e7edae290"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_2.png"></a></p>
<ol start="4">
<li>Tại giao diện <strong>Function code</strong>:
<ul>
<li>Tại phần <strong>Code source</strong>, bấm vào <strong>Upload from</strong> và chọn <strong>Amazon S3 location</strong>.</li>
<li>Nhập đường dẫn đến file <code>rds-to-s3-lambda.zip</code> mà chúng ta đã upload lên S3 ở phần trước.</li>
<li>Bấm <strong>Save</strong>.</li>
</ul>
</li>
</ol>
<p><a href="#R-image-528e9e730d36973ba0e8ad7161ad40cf" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_5.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-528e9e730d36973ba0e8ad7161ad40cf"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_5.png"></a></p>
<p><a href="#R-image-8fc16c5de0ed9c8a96b7040db00bd8db" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_6.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-8fc16c5de0ed9c8a96b7040db00bd8db"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_6.png"></a></p>
<ol start="5">
<li>Sau khi upload thành công, bấm vào <strong>Configuration</strong>
<ul>
<li>Ở phần <strong>General configuration</strong>, bấm <strong>Edit</strong>.</li>
<li>Tại phần <strong>Memory</strong> tăng giá trị lên <code>512 MB</code>.</li>
<li>Tại phần <strong>Timeout</strong>, nhập giá trị là <code>5 minutes</code>.</li>
<li>Bấm <strong>Save</strong>.</li>
</ul>
</li>
</ol>
<p><a href="#R-image-3c3dcf053520115ae58f165acc7239ab" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_7.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-3c3dcf053520115ae58f165acc7239ab"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_7.png"></a></p>
<ol start="6">
<li>Tại giao diện <strong>Configuration</strong>, bấm vào <strong>Environment variables</strong>.
<ul>
<li>Bấm <strong>Edit</strong>.</li>
<li>Bấm <strong>Add environment variable</strong>.</li>
<li>Nhập các biến môi trường sau:
<ul>
<li><code>RDS_HOST</code>: Địa chỉ endpoint của Amazon RDS mà chúng ta đã tạo ở phần trước.</li>
<li><code>RDS_PASSWORD</code>: Mật khẩu của user <code>postgres</code> mà chúng ta đã tạo ở phần trước.</li>
<li><code>S3_BUCKET</code>: <code>fashion-landing-zone</code>.</li>
</ul>
</li>
<li>Bấm <strong>Save</strong>.</li>
</ul>
</li>
</ol>
<p><a href="#R-image-cf45ebf10d19d1a80664d1092fcf0512" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_8.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-cf45ebf10d19d1a80664d1092fcf0512"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_8.png"></a></p>
<ol start="7">
<li>Tại giao diện <strong>Configuration</strong>, bấm vào <strong>VPC</strong>.
<ul>
<li>Chọn <strong>Edit</strong></li>
<li>Tại phần <strong>VPC</strong>, chọn VPC mà chúng ta đã tạo ở phần trước.</li>
<li>Tại phần <strong>Subnets</strong>, chọn 2 subnet private mà chúng ta đã tạo ở phần trước.
<ul>
<li>fashion-subnet-private1-ap-southeast-1a</li>
<li>fashion-subnet-private2-ap-southeast-1b</li>
</ul>
</li>
<li>Select <strong>Security groups</strong> chọn default security group của VPC.</li>
<li>Bấm <strong>Save</strong>.</li>
</ul>
</li>
</ol>
<p><a href="#R-image-1f6322df1cea9d6deb7d00950b215119" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_9.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-1f6322df1cea9d6deb7d00950b215119"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_9.png"></a></p>
<h2 id="cho-phép-lambda-truy-cập-vào-rds">Cho phép Lambda truy cập vào RDS</h2>
<ol>
<li>Quay lại giao diện fashion-db tại phần <strong>Databases</strong> tại giao diện RDS.</li>
<li>Kéo xuống phần <strong>Connected compute resources</strong>, bấm vào <strong>Acion</strong>, chọn <strong>Set up Lambda connection</strong></li>
</ol>
<p><a href="#R-image-4450c895d2eb3c93af5453f137c619b6" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_10.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4450c895d2eb3c93af5453f137c619b6"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_10.png"></a></p>
<ol start="3">
<li>Trong giao diện Set up Lambda connection
<ul>
<li>Chọn choosing existing function</li>
<li>Chọn hàm <code>lambda-rds-to-s3</code> mà chúng ta đã tạo ở phần trước.</li>
<li>Tắt tùy chọn <strong>Connect using Proxy</strong></li>
<li>Bấm <strong>Set up</strong></li>
</ul>
</li>
</ol>
<p><a href="#R-image-985d0f5a2013659a31413bfe28a99c94" class="lightbox-link"><img alt="img.png" class="lazy lightbox figure-image" loading="lazy" src="/images/rds-to-s3/img_11.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-985d0f5a2013659a31413bfe28a99c94"><img alt="img.png" class="lazy lightbox lightbox-image" loading="lazy" src="/images/rds-to-s3/img_11.png"></a></p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a id="R-logo" href="/vi/index.html">
    <img src="https://freepnglogo.com/images/all_img/1726309795amazon-web-services-logo-png.png" alt="brand logo" width="100" height="50" class="logo" loading="lazy" style="width: 84px; height: 50px; margin: 0 auto; display: block; text-align: center;" />
  </a>
        </div>
        <search><form action="/vi/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Tìm kiếm (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Tìm kiếm</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Tìm kiếm...">
            <button class="search-clear" type="button" data-search-clear="" title="Xóa tìm kiếm"><i class="fas fa-times" title="Xóa tìm kiếm"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/vi/overview/index.html"><a class="padding" href="/vi/overview/index.html">1. Giới thiệu<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/index.html"><input type="checkbox" id="R-section-5d3dc0156e97e93929ea76c794397c6c" aria-controls="R-subsections-5d3dc0156e97e93929ea76c794397c6c"><label for="R-section-5d3dc0156e97e93929ea76c794397c6c"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Menu con 2. Các bước chuẩn bị</span></label><a class="padding" href="/vi/preparation/index.html">2. Các bước chuẩn bị<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-5d3dc0156e97e93929ea76c794397c6c" class="collapsible-menu">
            <li class="" data-nav-id="/vi/preparation/setup-role/index.html"><a class="padding" href="/vi/preparation/setup-role/index.html">2.1 Tạo các Role cần thiết<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/setup-env/index.html"><a class="padding" href="/vi/preparation/setup-env/index.html">2.2 Tạo VPC, Subnet, ...<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/setup-ec2/index.html"><a class="padding" href="/vi/preparation/setup-ec2/index.html">2.3 Tạo EC2 Instance<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/setup-rds/index.html"><a class="padding" href="/vi/preparation/setup-rds/index.html">2.4 Tạo RDS<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/setup-s3/index.html"><a class="padding" href="/vi/preparation/setup-s3/index.html">2.5 Tạo S3 Bucket<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/preparation/setup-kinesis/index.html"><a class="padding" href="/vi/preparation/setup-kinesis/index.html">2.6 Tạo Kinesis Data Stream<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
            <li class="" data-nav-id="/vi/generate-data/index.html"><a class="padding" href="/vi/generate-data/index.html">3. Tạo môi trường ứng dụng<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="active " data-nav-id="/vi/rds-to-s3/index.html"><a class="padding" href="/vi/rds-to-s3/index.html">4. Trích xuất dữ liệu từ RDS vào S3<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/test-connection/index.html"><input type="checkbox" id="R-section-1a0528a68276c9c3c0d85cb2378ffaf7" aria-controls="R-subsections-1a0528a68276c9c3c0d85cb2378ffaf7"><label for="R-section-1a0528a68276c9c3c0d85cb2378ffaf7"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Menu con 5. Test dữ liệu</span></label><a class="padding" href="/vi/test-connection/index.html">5. Test dữ liệu<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-1a0528a68276c9c3c0d85cb2378ffaf7" class="collapsible-menu">
            <li class="" data-nav-id="/vi/test-connection/test-rds/index.html"><a class="padding" href="/vi/test-connection/test-rds/index.html">5.1 Kiểm tra dữ liệu trong RDS<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/test-connection/test-kinesis/index.html"><a class="padding" href="/vi/test-connection/test-kinesis/index.html">5.2 Kiểm tra dữ liệu trong Kinesis Data Stream<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/vi/test-connection/test-lambda/index.html"><a class="padding" href="/vi/test-connection/test-lambda/index.html">5.3 Test Lambda Function<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
			<li class="R-languageswitcher">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-language"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <label class="a11y-only" for="R-select-language">Ngôn ngữ</label>
                  <select id="R-select-language">
                    <option id="R-select-language-vi" value="vi" data-url="/vi/rds-to-s3/index.html" lang="vi" selected data-selected>Vietnamese</option>
                  </select>
                </div>
                <div class="clear"></div>
              </div>
            </li>
            <li class="R-historyclearer">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-history"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <button>Xóa lịch sử..</button>
                </div>
                <div class="clear"></div>
              </div>
            </li>
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/clipboard/clipboard.min.js?1744901602" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1744901602" defer></script>
    <script src="/js/theme.js?1744901602" defer></script>
  </body>
</html>
